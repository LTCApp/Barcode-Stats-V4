<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <title>ุณูู ุงูุฌููุฉ</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#d32f2f">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <script src="https://unpkg.com/html5-qrcode@2.3.7"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <link rel="stylesheet" href="style.css">
  <script defer src="app.js"></script>
</head>
<body>
  <!-- ุดุงุดุฉ ุงูุชุญููู -->
  <div id="loadingScreen" class="loading-screen">
    <div class="loading-container">
      <div class="logo-loading">
        <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" fill="white" viewBox="0 0 24 24">
          <rect x="2" y="4" width="3" height="16" fill="white"/>
          <rect x="6" y="4" width="1.5" height="16" fill="white"/>
          <rect x="9" y="4" width="2.5" height="16" fill="white"/>
          <rect x="13" y="4" width="1.5" height="16" fill="white"/>
          <rect x="16" y="4" width="3" height="16" fill="white"/>
          <rect x="20" y="4" width="1.5" height="16" fill="white"/>
        </svg>
      </div>
      <h1 class="loading-title">ุณูู ุงูุฌููุฉ</h1>
      <p class="loading-subtitle">Barcode Stats</p>
      <div class="loading-spinner">
        <div class="spinner-ring"></div>
        <div class="spinner-ring"></div>
        <div class="spinner-ring"></div>
      </div>
      <p class="loading-text">ุฌุงุฑู ุงูุชุญููู...</p>
    </div>
  </div>

  <!-- ุงููุญุชูู ุงูุฑุฆูุณู -->
  <div id="mainContent" class="main-content hidden">
    <audio id="scanSound" src="scanner.mp3" preload="auto"></audio>
    
    <header class="app-header">
      <div class="logo">
        <div class="logo-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="white" viewBox="0 0 24 24">
            <rect x="2" y="4" width="2" height="16" fill="white"/>
            <rect x="6" y="4" width="1" height="16" fill="white"/>
            <rect x="9" y="4" width="2" height="16" fill="white"/>
            <rect x="13" y="4" width="1" height="16" fill="white"/>
            <rect x="16" y="4" width="2" height="16" fill="white"/>
            <rect x="20" y="4" width="1" height="16" fill="white"/>
          </svg>
        </div>
        <div class="logo-text">
          <span class="app-title">ุณูู ุงูุฌููุฉ</span>
          <span class="app-subtitle">Barcode Stats</span>
        </div>
      </div>
      <div class="header-actions">
        <button id="uploadBtn" class="header-btn" title="ุฑูุน ููู ุงูุฃููุงุฏ">
          <i class="fa-solid fa-upload"></i>
          <span>ุฑูุน ููู</span>
        </button>
        <button id="scanBtn" class="header-btn" title="ูุณุญ ุจุงุฑููุฏ">
          <i class="fa-solid fa-qrcode"></i>
          <span>ูุณุญ</span>
        </button>
        <button id="exportBtn" class="header-btn" title="ุฅุฑุณุงู ูุงุฆูุฉ ุงูุฃููุงุฏ ุนุจุฑ ูุงุชุณุงุจ">
          <i class="fa-brands fa-whatsapp"></i>
          <span>ูุงุชุณุงุจ</span>
        </button>
        <button id="clearBtn" class="header-btn danger" title="ุญุฐู ุฌููุน ุงูุจูุงูุงุช">
          <i class="fa-solid fa-trash"></i>
          <span>ุญุฐู ุงููู</span>
        </button>
      </div>
      
      <!-- ูุฏุฎู ุฑูุน ุงูููู ุงููุฎูู -->
      <input type="file" id="fileInput" accept=".xlsx,.xls" style="display: none;">
    </header>

    <!-- ุฅุญุตุงุฆูุงุช ุณุฑูุนุฉ -->
    <div class="stats-container">
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fa-solid fa-barcode"></i>
        </div>
        <div class="stat-info">
          <span class="stat-number" id="totalCount">0</span>
          <span class="stat-label">ุฅุฌูุงูู</span>
        </div>
      </div>
      <div class="stat-card available">
        <div class="stat-icon">
          <i class="fa-solid fa-check-circle"></i>
        </div>
        <div class="stat-info">
          <span class="stat-number" id="availableCount">0</span>
          <span class="stat-label">ูุชููุฑ</span>
        </div>
      </div>
      <div class="stat-card unavailable">
        <div class="stat-icon">
          <i class="fa-solid fa-times-circle"></i>
        </div>
        <div class="stat-info">
          <span class="stat-number" id="unavailableCount">0</span>
          <span class="stat-label">ุบูุฑ ูุชููุฑ</span>
        </div>
      </div>
    </div>

    <main class="main-section">
      <div class="section-header">
        <h2><i class="fa-solid fa-list"></i> ูุงุฆูุฉ ุงูุฃููุงุฏ</h2>
        <div class="search-container">
          <input type="text" id="searchInput" placeholder="ุงูุจุญุซ ูู ุงูุฃููุงุฏ..." class="search-input">
          <i class="fa-solid fa-search search-icon"></i>
        </div>
      </div>
      
      <div class="empty-state" id="emptyState">
        <div class="empty-icon">
          <i class="fa-solid fa-barcode"></i>
        </div>
        <h3>ูุง ุชูุฌุฏ ุฃููุงุฏ ุจุนุฏ</h3>
        <p>ุงุจุฏุฃ ุจูุณุญ ุฃูู ุจุงุฑููุฏ ุฃู ุฃุถู ููุฏ ูุฏููุงู</p>
        <button class="btn-primary" onclick="document.getElementById('scanBtn').click()">
          <i class="fa-solid fa-qrcode"></i>
          ูุณุญ ุจุงุฑููุฏ ุฌุฏูุฏ
        </button>
      </div>

      <ul id="barcodeList" class="barcode-list" aria-live="polite"></ul>
    </main>

    <!-- ููุฏุงู ุงููุงุณุญ -->
    <div id="scannerModal" class="modal hidden" role="dialog" aria-modal="true">
      <div class="modal-content">
        <div class="modal-header">
          <h2><i class="fa-solid fa-qrcode"></i> ูุณุญ ุจุงุฑููุฏ</h2>
          <button id="closeScanner" class="close-btn">
            <i class="fa-solid fa-times"></i>
          </button>
        </div>
        
        <div class="tabs">
          <button class="tab active" data-tab="cameraTab">
            <i class="fa-solid fa-camera"></i>
            <span>ูุงููุฑุง</span>
          </button>
          <button class="tab" data-tab="manualTab">
            <i class="fa-solid fa-keyboard"></i>
            <span>ุฅุฏุฎุงู ูุฏูู</span>
          </button>
        </div>
        
        <div id="cameraTab" class="tab-content active">
          <div class="camera-container">
            <video id="video" autoplay playsinline muted></video>
            <div id="reader" class="reader" style="display:none;"></div>
            <div class="camera-overlay">
              <div class="scan-frame"></div>
              <!-- ุดุนุงุฑ ุงูุชุญุฐูุฑ ููุจุงุฑููุฏุงุช ุบูุฑ ุงููุนุฑููุฉ -->
              <div id="rescanWarning" class="rescan-warning hidden">
                <div class="warning-icon">โ๏ธ</div>
                <div class="warning-text">ุฃุนุฏ ูุณุญ ุงูุจุงุฑููุฏ</div>
                <div class="warning-subtext">ูุฐุง ุงูุจุงุฑููุฏ ุบูุฑ ูุนุฑูู</div>
              </div>
              <!-- ุฅุดุนุงุฑ ุงููุฌุงุญ ูู ููุชุตู ุงููุงููุฑุง -->
              <div id="successOverlay" class="success-overlay hidden">
                <div class="success-icon">โ</div>
                <div class="success-text">ุชู ุฅุถุงูุฉ ุงูุจุงุฑููุฏ ุจูุฌุงุญ</div>
                <div class="success-subtext">ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช</div>
              </div>
            </div>
            <button id="flashBtn" class="flash-btn" title="ุชุดุบูู/ุฅููุงู ุงูููุงุด">
              <i class="fa-solid fa-bolt"></i>
            </button>
          </div>
          <p class="scan-instruction">ูุฌู ุงููุงููุฑุง ูุญู ุงูุจุงุฑููุฏ ูููุณุญ ุงูุชููุงุฆู</p>
        </div>
        
        <div id="manualTab" class="tab-content">
          <div class="manual-input-container">
            <div class="input-group">
              <input id="manualInput" type="text" inputmode="numeric" pattern="\\d*" 
                     placeholder="ุฃุฏุฎู ุฑูู ุงูุจุงุฑููุฏ..." class="manual-input">
              <button id="addManualBtn" class="btn-add">
                <i class="fa-solid fa-plus"></i>
                <span>ุฅุถุงูุฉ</span>
              </button>
            </div>
            <p class="input-hint">
              <i class="fa-solid fa-info-circle"></i>
              ููุณูุญ ุจุงูุฃุฑูุงู ููุท
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- ููุฏุงู ุงูุชุฃููุฏ -->
    <div id="confirmModal" class="modal hidden">
      <div class="modal-content small">
        <div class="modal-header">
          <h2>ุชุฃููุฏ ุงูุนูููุฉ</h2>
          <button id="closeConfirm" class="close-btn"><i class="fa-solid fa-times"></i></button>
        </div>
        <div class="modal-body">
          <p id="confirmMessage"></p>
        </div>
        <div class="modal-footer">
          <button id="confirmYes" class="btn-primary">ุชุฃููุฏ</button>
          <button id="confirmNo" class="btn-cancel">ุฅูุบุงุก</button>
        </div>
      </div>
    </div>

    <!-- ุฒุฑ ุงูุชุซุจูุช -->
    <button id="installBtn" class="install-btn" style="display:none;">๐ฒ ุชุซุจูุช ุงูุชุทุจูู</button>

    <div id="toast" class="toast"></div>

    <script src="pwa.js"></script>
  </div>
</body>
</html>